<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fire of Life ‚Äî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –°–æ—Å—Ç–æ—è–Ω–∏—è</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Italiana&family=Lora:ital,wght@0,400;0,500;1,400&display=swap');

        /* Typography */
        body { 
            font-family: 'Lora', serif; 
            margin: 0; 
            padding: 0; 
            background-color: #0f0e17; 
            overflow: hidden; 
        }
        
        h1, h2, h3, .serif { font-family: 'Cinzel', serif; letter-spacing: 0.05em; }
        .elegant { font-family: 'Italiana', serif; }

        /* Keyframes */
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slide-in-right { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes zoom-slow { from { transform: scale(1); } to { transform: scale(1.15); } }
        @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.15); opacity: 1; } }
        @keyframes rise {
            0% { transform: translateY(0) scale(1); opacity: 0; }
            50% { opacity: 0.5; }
            100% { transform: translateY(-100vh) scale(0); opacity: 0; }
        }
        
        .animate-fade-in-up { animation: fade-in-up 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        .animate-slide-in { animation: slide-in-right 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        .animate-zoom { animation: zoom-slow 25s ease-in-out infinite alternate; }
        .animate-spin-slow { animation: spin-slow 30s linear infinite; }
        .animate-breathe { animation: breathe 5s ease-in-out infinite; }
        .animate-rise { animation: rise 12s infinite linear; }
        
        .glass-card {
            backdrop-filter: blur(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .glass-card:hover { transform: translateY(-4px); }
        
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .btn-primary {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .btn-primary:active { transform: scale(0.98); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { icons } = lucide;

        // --- ICON WRAPPER ---
        const LucideIcon = ({ icon, ...props }) => {
            if (!icon) return null;
            return (
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width="24" 
                    height="24" 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round"
                    {...props}
                >
                    {icon.map(([tag, attrs], i) => React.createElement(tag, { ...attrs, key: i }))}
                </svg>
            );
        };

        const Sparkles = (props) => <LucideIcon icon={icons.Sparkles} {...props} />;
        const ArrowRight = (props) => <LucideIcon icon={icons.ArrowRight} {...props} />;
        const ArrowLeft = (props) => <LucideIcon icon={icons.ArrowLeft} {...props} />;
        const RotateCcw = (props) => <LucideIcon icon={icons.RotateCcw} {...props} />;
        const Wind = (props) => <LucideIcon icon={icons.Wind} {...props} />;
        const Droplets = (props) => <LucideIcon icon={icons.Droplets} {...props} />;
        const Flame = (props) => <LucideIcon icon={icons.Flame} {...props} />;
        const Mountain = (props) => <LucideIcon icon={icons.Mountain} {...props} />;
        const MessageCircle = (props) => <LucideIcon icon={icons.MessageCircle} {...props} />;
        const Share2 = (props) => <LucideIcon icon={icons.Share2} {...props} />;
        const Eye = (props) => <LucideIcon icon={icons.Eye} {...props} />;
        const Star = (props) => <LucideIcon icon={icons.Star} {...props} />;
        const Lock = (props) => <LucideIcon icon={icons.Lock} {...props} />;
        const Sun = (props) => <LucideIcon icon={icons.Sun} {...props} />;
        const Moon = (props) => <LucideIcon icon={icons.Moon} {...props} />;
        const Heart = (props) => <LucideIcon icon={icons.Heart} {...props} />;
        const Gift = (props) => <LucideIcon icon={icons.Gift} {...props} />;

        // --- THEMES ---
        const THEMES = {
            dark: {
                id: 'dark',
                bg: '#0f0e17',
                bgGradient: 'linear-gradient(135deg, #0f0e17 0%, #1a1625 50%, #0f0e17 100%)',
                text: '#f2f0e8',
                accent: '#D4AF37', 
                secondary: '#a09181',
                cardBg: 'rgba(26, 22, 37, 0.5)',
                cardBorder: 'rgba(212, 175, 55, 0.15)',
                shadow: 'rgba(0, 0, 0, 0.5)',
                buttonText: '#0f0e17'
            },
            light: {
                id: 'light',
                bg: '#faf8f3',
                bgGradient: 'linear-gradient(135deg, #faf8f3 0%, #f5f1e8 50%, #faf8f3 100%)',
                text: '#2d2a32',
                accent: '#9e2a2b',
                secondary: '#7a7269',
                cardBg: 'rgba(255, 255, 255, 0.6)',
                cardBorder: 'rgba(158, 42, 43, 0.2)',
                shadow: 'rgba(0, 0, 0, 0.1)',
                buttonText: '#ffffff'
            }
        };

        // --- CONTENT ---
        const LANDSCAPES = [
            { id: 'desert', img: 'https://images.unsplash.com/photo-1473580044384-7ba9967e16a0?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', title: '–ë–µ—Å–∫—Ä–∞–π–Ω—è—è –ü—É—Å—Ç—ã–Ω—è', desc: '–ß—É–≤—Å—Ç–≤–æ –ø—É—Å—Ç–æ—Ç—ã, —Ç–∏—à–∏–Ω—ã, –Ω–æ –∏ –∂–∞–∂–¥—ã.', trait: '–ü—É—Å—Ç–æ—Ç–∞/–ñ–∞–∂–¥–∞' },
            { id: 'storm', img: 'https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', title: '–ë—É—à—É—é—â–∏–π –û–∫–µ–∞–Ω', desc: '–ú–Ω–æ–≥–æ —ç–º–æ—Ü–∏–π, —Ö–∞–æ—Å, —Å–∏–ª–∞, –∫–æ—Ç–æ—Ä—É—é —Ç—Ä—É–¥–Ω–æ —Å–¥–µ—Ä–∂–∞—Ç—å.', trait: '–•–∞–æ—Å/–≠–º–æ—Ü–∏–∏' },
            { id: 'fog', img: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', title: '–¢—É–º–∞–Ω–Ω—ã–π –õ–µ—Å', desc: '–ù–µ—è—Å–Ω–æ—Å—Ç—å –ø—É—Ç–∏, –∑–∞–≥–∞–¥–∫–∞, –ø–æ—Ç–µ—Ä—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤.', trait: '–ù–µ—è—Å–Ω–æ—Å—Ç—å' },
            { id: 'volcano', img: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', title: '–°–ø—è—â–∏–π –í—É–ª–∫–∞–Ω', desc: '–°–∫—Ä—ã—Ç–∞—è –º–æ—â—å, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, –≥–æ—Ç–æ–≤–æ–µ –≤—ã—Ä–≤–∞—Ç—å—Å—è.', trait: '–°–∫—Ä—ã—Ç–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ' }
        ];

        const ELEMENTS = [
            { id: 'water', icon: Droplets, title: '–ñ–∏–≤–∞—è –í–æ–¥–∞', desc: '–°–º—ã—Ç—å –ª–∏—à–Ω–µ–µ, –Ω–∞–ø–æ–ª–Ω–∏—Ç—å, –æ–∂–∏–≤–∏—Ç—å.', type: '–≠–º–æ—Ü–∏–∏' },
            { id: 'fire', icon: Flame, title: '–°–≤—è—â–µ–Ω–Ω—ã–π –û–≥–æ–Ω—å', desc: '–°–æ–≥—Ä–µ—Ç—å, –æ—Å–≤–µ—Ç–∏—Ç—å –ø—É—Ç—å, —Å–∂–µ—á—å —Å—Ç–∞—Ä–æ–µ.', type: '–≠–Ω–µ—Ä–≥–∏—è' },
            { id: 'earth', icon: Mountain, title: '–¢–≤–µ—Ä–¥–∞—è –ó–µ–º–ª—è', desc: '–î–∞—Ç—å –æ–ø–æ—Ä—É, —É–∫–æ—Ä–µ–Ω–∏—Ç—å, –∑–∞—â–∏—Ç–∏—Ç—å.', type: '–û–ø–æ—Ä–∞' },
            { id: 'air', icon: Wind, title: '–°–≤–µ–∂–∏–π –í–µ—Ç–µ—Ä', desc: '–ü—Ä–∏–Ω–µ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω—ã, –ª–µ–≥–∫–æ—Å—Ç—å, –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ.', type: '–ü–µ—Ä–µ–º–µ–Ω—ã' }
        ];

        const DOORS = [
            { id: 'scale', title: '–ú–∞—Å—à—Ç–∞–±', desc: '–Ø –≥–æ—Ç–æ–≤–∞ –ø—Ä–æ—è–≤–∏—Ç—å—Å—è' },
            { id: 'depth', title: '–ì–ª—É–±–∏–Ω–∞', desc: '–Ø —Ö–æ—á—É –ø–æ–Ω—è—Ç—å —Å–µ–±—è' }, 
            { id: 'love', title: '–õ—é–±–æ–≤—å', desc: '–Ø —Ö–æ—á—É –æ—Ç–∫—Ä—ã—Ç—å —Å–µ—Ä–¥—Ü–µ' },
            { id: 'magic', title: '–ß—É–¥–æ', desc: '–Ø —Ö–æ—á—É –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∂–µ–ª–∞–Ω–∏—è' }
        ];

        const getResultKey = (elementId, doorId) => {
            const isActiveElement = elementId === 'fire' || elementId === 'air';
            if (doorId === 'love') return isActiveElement ? 'sensual_passion' : 'sensual_soft';
            if (doorId === 'depth') return isActiveElement ? 'depth_mountain' : 'depth_roots';
            if (doorId === 'scale') return isActiveElement ? 'scale_flight' : 'scale_river';
            if (doorId === 'magic') return isActiveElement ? 'magic_star' : 'magic_crystal';
            return 'sensual_soft'; 
        };

        const RESULTS = {
            sensual_passion: {
                cardTitle: "–ü–ª–∞–º–µ–Ω–Ω–∞—è –†–æ–∑–∞",
                cardImage: "https://images.unsplash.com/photo-1548123281-797746816553?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –°—Ç—Ä–∞—Å—Ç–∏",
                text: "–í —Ç–µ–±–µ –≥–æ—Ä–∏—Ç –æ–≥–æ–Ω—å, –∫–æ—Ç–æ—Ä—ã–π –∏—â–µ—Ç –≤—ã—Ö–æ–¥–∞. –¢–≤–æ—è –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —è—Ä–∫–∞—è, –∞–∫—Ç–∏–≤–Ω–∞—è. –ü–æ–∑–≤–æ–ª—å —Å–µ–±–µ –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω–æ–π –∏ –∂–µ–ª–∞–Ω–Ω–æ–π.",
                productName: "–°–≤–µ—á–∞ ¬´SENSUAL¬ª",
                productPrice: "5 000 ‚ÇΩ",
                color: "#be185d",
                icon: Flame
            },
            sensual_soft: {
                cardTitle: "–ù–µ–∂–Ω—ã–π –õ–æ—Ç–æ—Å",
                cardImage: "https://images.unsplash.com/photo-1518895949257-7621c3c786d7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–ú—è–≥–∫–∞—è –ñ–µ–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å",
                text: "–¢–≤–æ—è —Å–∏–ª–∞ –≤ –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏–∏. –°–µ–π—á–∞—Å —Ç–µ–±–µ –Ω–µ –Ω—É–∂–Ω–æ –Ω–∏—á–µ–≥–æ –¥–æ–∫–∞–∑—ã–≤–∞—Ç—å, —Ç–æ–ª—å–∫–æ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –∏ –±—ã—Ç—å –≤ –ø–æ—Ç–æ–∫–µ.",
                productName: "–°–≤–µ—á–∞ ¬´SENSUAL¬ª",
                productPrice: "5 000 ‚ÇΩ",
                color: "#db2777",
                icon: Heart
            },
            depth_mountain: {
                cardTitle: "–í–µ—Ä—à–∏–Ω–∞ –ì–æ—Ä—ã",
                cardImage: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –°–∏–ª–∞",
                text: "–¢—ã –≥–æ—Ç–æ–≤–∞ –≤–∑—è—Ç—å –Ω–æ–≤—É—é –≤—ã—Å–æ—Ç—É. –¢–≤–æ—è –æ–ø–æ—Ä–∞ ‚Äî —ç—Ç–æ —Ç–≤–æ–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∏ –≤–æ–ª—è. –•–∞–æ—Å –æ—Ç—Å—Ç—É–ø–∞–µ—Ç –ø–µ—Ä–µ–¥ —Ç–≤–æ–µ–π —Ä–µ—à–∏–º–æ—Å—Ç—å—é.",
                productName: "–°–≤–µ—á–∞ ¬´HEART OF A MAN¬ª",
                productPrice: "7 000 ‚ÇΩ",
                color: "#854d0e",
                icon: Mountain
            },
            depth_roots: {
                cardTitle: "–ú—É–¥—Ä–æ—Å—Ç—å –ö–æ—Ä–Ω–µ–π",
                cardImage: "https://images.unsplash.com/photo-1542273917363-3b1817f69a2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–ì–ª—É–±–æ–∫–æ–µ –ó–∞–∑–µ–º–ª–µ–Ω–∏–µ",
                text: "–û—Ç–≤–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –∏—â–µ—à—å, –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≥–ª—É–±–æ–∫–æ –≤–Ω—É—Ç—Ä–∏. –¢–µ–±–µ –Ω—É–∂–Ω–∞ —Ç–∏—à–∏–Ω–∞ –∏ —Å–≤—è–∑—å —Å —Ä–æ–¥–æ–º, —á—Ç–æ–±—ã —É—Å–ª—ã—à–∞—Ç—å –∏—Ö.",
                productName: "–°–≤–µ—á–∞ ¬´HEART OF A MAN¬ª",
                productPrice: "7 000 ‚ÇΩ",
                color: "#57534e",
                icon: Mountain
            },
            scale_flight: {
                cardTitle: "–ü–æ–ª–µ—Ç –û—Ä–ª–∞",
                cardImage: "https://images.unsplash.com/photo-1500491460312-c32fc2dbc751?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–ë–µ–∑–≥—Ä–∞–Ω–∏—á–Ω–∞—è –°–≤–æ–±–æ–¥–∞",
                text: "–¢—ã –ø–µ—Ä–µ—Ä–æ—Å–ª–∞ —Å–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ. –¢–≤–æ—è –¥—É—à–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–µ—Ç–∞. –ù–µ –±–æ–π—Å—è –æ—Ç–ø—É—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä–æ–µ, –∫—Ä—ã–ª—å—è —É–∂–µ –æ–∫—Ä–µ–ø–ª–∏.",
                productName: "–°–≤–µ—á–∞ ¬´FREEDOM¬ª",
                productPrice: "5 500 ‚ÇΩ",
                color: "#0ea5e9",
                icon: Wind
            },
            scale_river: {
                cardTitle: "–ë—É—Ä–Ω–∞—è –†–µ–∫–∞",
                cardImage: "https://images.unsplash.com/photo-1437482096227-6a12e3f8c6f7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–ü–æ—Ç–æ–∫ –ò–∑–æ–±–∏–ª–∏—è",
                text: "–¢–≤–æ–π –º–∞—Å—à—Ç–∞–± ‚Äî –≤ –¥–≤–∏–∂–µ–Ω–∏–∏. –ö–∞–∫ —Ä–µ–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø—É—Ç—å –∫ –æ–∫–µ–∞–Ω—É, —Ç–∞–∫ –∏ —Ç—ã –Ω–∞–π–¥–µ—à—å –ø—É—Ç—å –∫ —Å–≤–æ–µ–π —Ü–µ–ª–∏, –µ—Å–ª–∏ –¥–æ–≤–µ—Ä–∏—à—å—Å—è —Ç–µ—á–µ–Ω–∏—é.",
                productName: "–°–≤–µ—á–∞ ¬´FREEDOM¬ª",
                productPrice: "5 500 ‚ÇΩ",
                color: "#0284c7",
                icon: Droplets
            },
            magic_star: {
                cardTitle: "–ü—É—Ç–µ–≤–æ–¥–Ω–∞—è –ó–≤–µ–∑–¥–∞",
                cardImage: "https://images.unsplash.com/photo-1419242902214-272b3f66ee7a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è –°–≤—è–∑—å",
                text: "–¢—ã —Å–µ–π—á–∞—Å –æ—Ç–∫—Ä—ã—Ç–∞ –í—Å–µ–ª–µ–Ω–Ω–æ–π –∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞. –¢–≤–æ–∏ –º—ã—Å–ª–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å. –ú–µ—á—Ç–∞–π —Å–º–µ–ª–æ.",
                productName: "–°–≤–µ—á–∞ ¬´WISH¬ª",
                productPrice: "5 500 ‚ÇΩ",
                color: "#a855f7",
                icon: Sparkles
            },
            magic_crystal: {
                cardTitle: "–ß–∏—Å—Ç—ã–π –ö—Ä–∏—Å—Ç–∞–ª–ª",
                cardImage: "https://images.unsplash.com/photo-1515266591878-5a140887de73?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                title: "–Ø—Å–Ω–æ—Å—Ç—å –ù–∞–º–µ—Ä–µ–Ω–∏—è",
                text: "–ú–∞–≥–∏—è ‚Äî —ç—Ç–æ –Ω–µ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å, —ç—Ç–æ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–æ–ª—è. –û—á–∏—Å—Ç–∏ —Å–æ–∑–Ω–∞–Ω–∏–µ, –∏ —Ç–≤–æ–µ –∂–µ–ª–∞–Ω–∏–µ –∫—Ä–∏—Å—Ç–∞–ª–ª–∏–∑—É–µ—Ç—Å—è –≤ –º–∞—Ç–µ—Ä–∏–∏.",
                productName: "–°–≤–µ—á–∞ ¬´WISH¬ª",
                productPrice: "5 500 ‚ÇΩ",
                color: "#7c3aed",
                icon: Eye
            }
        };

        // --- COMPONENTS ---
        const ProgressBar = ({ current, total, theme }) => {
            const progress = (current / total) * 100;
            return (
                <div className="absolute top-0 left-0 right-0 z-50">
                <div 
                    className="h-1 transition-all duration-700 ease-out"
                    style={{
                    width: `${progress}%`,
                    background: `linear-gradient(90deg, ${theme.accent}, ${theme.accentLight})`,
                    boxShadow: `0 0 15px ${theme.accent}80`
                    }}
                />
                </div>
            );
        };

        const BackButton = ({ onClick, theme }) => (
            <button
                onClick={onClick}
                className="absolute top-6 left-6 z-40 w-10 h-10 rounded-full glass-card flex items-center justify-center group border hover:scale-105"
                style={{ background: theme.cardBg, borderColor: theme.cardBorder }}
            >
                <ArrowLeft className="w-5 h-5 transition-transform group-hover:-translate-x-1" style={{ color: theme.text }} />
            </button>
        );

        const PageTransition = ({ children }) => (
            <div className="w-full min-h-full flex flex-col animate-slide-in relative">
                {children}
            </div>
        );

        // --- SCREENS ---
        const ScreenIntro = ({ onSelectTheme }) => {
            return (
                <div className="w-full h-full flex flex-col items-center justify-center p-8 text-center relative bg-[#0f0e17] overflow-hidden">
                <div className="absolute inset-0 bg-gradient-to-br from-[#1a1625] via-[#0f0e17] to-[#0a0a0f]"></div>
                <div className="absolute inset-0 overflow-hidden pointer-events-none">
                    {[...Array(20)].map((_, i) => (
                        <div key={i} className="absolute bg-white rounded-full opacity-0 animate-rise" style={{ left: `${Math.random() * 100}%`, bottom: `-20px`, width: `${Math.random() * 3 + 1}px`, height: `${Math.random() * 3 + 1}px`, opacity: Math.random() * 0.4 + 0.1, animationDuration: `${Math.random() * 15 + 10}s`, animationDelay: `${Math.random() * 5}s` }} />
                    ))}
                </div>
                
                <div className="relative z-10 max-w-md w-full flex flex-col items-center justify-center min-h-[500px] animate-fade-in-up">
                    <div className="mb-16">
                    <h1 className="elegant text-3xl text-[#f2f0e8] tracking-[0.25em] font-normal mb-3 inline-block border-b border-[#D4AF37]/30 pb-2">Fire of Life</h1>
                    </div>
                    <div className="flex justify-center items-center gap-10 w-full mb-12">
                    <button onClick={() => onSelectTheme('light')} className="group relative w-32 h-32 rounded-full focus:outline-none">
                        <div className="absolute inset-0 rounded-full bg-[#fcd34d] opacity-0 group-hover:opacity-40 blur-3xl transition-opacity duration-700"></div>
                        <div className="absolute inset-0 rounded-full bg-gradient-to-br from-[#fffbeb] via-[#fef3c7] to-[#fbbf24] shadow-[0_0_30px_rgba(251,191,36,0.15)] border border-white/20 flex items-center justify-center overflow-hidden transition-transform duration-500 group-hover:scale-105">
                            <Sun className="relative z-10 w-12 h-12 text-[#b45309] stroke-[1px] animate-spin-very-slow" />
                        </div>
                    </button>
                    <button onClick={() => onSelectTheme('dark')} className="group relative w-32 h-32 rounded-full focus:outline-none">
                        <div className="absolute inset-0 rounded-full bg-[#818cf8] opacity-0 group-hover:opacity-40 blur-3xl transition-opacity duration-700"></div>
                        <div className="absolute inset-0 rounded-full bg-gradient-to-br from-[#312e81] to-[#1e1b4b] shadow-[0_0_30px_rgba(99,102,241,0.15)] border border-white/10 flex items-center justify-center overflow-hidden transition-transform duration-500 group-hover:scale-105">
                            <Moon className="relative z-10 w-10 h-10 text-[#c7d2fe] stroke-[1px] fill-[#c7d2fe]/5 animate-pulse-soft" />
                        </div>
                    </button>
                    </div>
                    <p className="text-[#f2f0e8]/40 text-[10px] uppercase tracking-[0.3em] animate-fade-in-up" style={{ animationDelay: '0.4s' }}>–í—ã–±–µ—Ä–∏ —Å–≤–æ—é —Ç–µ–º—É</p>
                </div>
                </div>
            );
        };

        const ScreenLandscape = ({ onSelect, onBack, theme }) => {
            const [hoveredId, setHoveredId] = useState(null);
            return (
                <PageTransition>
                <ProgressBar current={1} total={4} theme={theme} />
                <BackButton onClick={onBack} theme={theme} />
                <div className="flex flex-col w-full h-full relative pt-20">
                    <div className="px-6 mb-8 shrink-0 animate-fade-in-up">
                    <span style={{ color: theme.accent }} className="text-[10px] tracking-[0.4em] uppercase block mb-3 font-semibold">–®–∞–≥ 1 –∏–∑ 3</span>
                    <h2 style={{ color: theme.text }} className="text-3xl display-font leading-tight font-semibold">–ï—Å–ª–∏ –±—ã —Ç–≤–æ—è –¥—É—à–∞<br/>–±—ã–ª–∞ –ø–µ–π–∑–∞–∂–µ–º,<br/>—Ç–æ –∫–∞–∫–∏–º?</h2>
                    </div>
                    <div className="flex-1 w-full overflow-y-auto pb-24 px-6 scrollbar-hide">
                    <div className="grid grid-cols-1 gap-5">
                        {LANDSCAPES.map((item, index) => (
                        <div key={item.id} onClick={() => onSelect(item)} onMouseEnter={() => setHoveredId(item.id)} onMouseLeave={() => setHoveredId(null)} className="group relative h-48 w-full rounded-3xl overflow-hidden cursor-pointer border-2 transition-all duration-500 shrink-0 animate-fade-in-up" style={{ borderColor: hoveredId === item.id ? theme.accent : theme.cardBorder, animationDelay: `${index * 0.1}s` }}>
                            <img src={item.img} alt={item.title} className="absolute inset-0 w-full h-full object-cover transition-all duration-700 opacity-60 group-hover:opacity-90" style={{ transform: hoveredId === item.id ? 'scale(1.1)' : 'scale(1)' }} />
                            <div className="absolute inset-0 transition-opacity duration-500" style={{ background: `linear-gradient(135deg, ${theme.bg}90 0%, transparent 100%)` }} />
                            <div className="absolute inset-0 p-7 flex flex-col justify-end">
                            <div className="transform transition-all duration-500" style={{ transform: hoveredId === item.id ? 'translateY(-8px)' : 'translateY(0)' }}>
                                <h3 className="text-2xl font-serif mb-2 transition-colors duration-300" style={{ color: hoveredId === item.id ? theme.accent : '#ffffff' }}>{item.title}</h3>
                                <p className="text-sm font-light transition-all duration-500" style={{ color: '#f0f0f0', opacity: hoveredId === item.id ? 1 : 0, transform: hoveredId === item.id ? 'translateY(0)' : 'translateY(10px)' }}>{item.desc}</p>
                            </div>
                            <div className="mt-3 text-xs tracking-wider uppercase opacity-0 group-hover:opacity-100 transition-all duration-500 flex items-center gap-2" style={{ color: theme.accent }}><span>–í—ã–±—Ä–∞—Ç—å</span><ArrowRight className="w-3 h-3" /></div>
                            </div>
                        </div>
                        ))}
                    </div>
                    </div>
                </div>
                </PageTransition>
            );
        };

        const ScreenElement = ({ landscape, onSelect, onBack, theme }) => {
            const IconComponent = ({ icon: Icon }) => <Icon className="w-6 h-6" />;
            return (
                <PageTransition>
                <ProgressBar current={2} total={4} theme={theme} />
                <BackButton onClick={onBack} theme={theme} />
                <div className="flex flex-col w-full h-full relative pt-20">
                    <div className="absolute inset-0 opacity-10 blur-3xl pointer-events-none"><img src={landscape.img} className="w-full h-full object-cover animate-zoom" /></div>
                    <div className="px-6 mb-10 shrink-0 animate-fade-in-up relative z-10">
                    <span style={{ color: theme.accent }} className="text-[10px] tracking-[0.4em] uppercase block mb-4 font-semibold">–®–∞–≥ 2 / 3</span>
                    <h2 style={{ color: theme.text }} className="text-3xl display-font leading-tight font-semibold mb-3">–ß–µ–≥–æ –ø—Ä–æ—Å–∏—Ç<br/>—ç—Ç–æ—Ç –ø–µ–π–∑–∞–∂?</h2>
                    <p style={{ color: theme.secondary }} className="text-sm italic font-light">–ö–∞–∫–∞—è —Å—Ç–∏—Ö–∏—è –æ–∂–∏–≤–∏—Ç {landscape.title.toLowerCase()}?</p>
                    </div>
                    <div className="flex-1 w-full overflow-y-auto pb-24 px-6 scrollbar-hide relative z-10">
                    <div className="grid grid-cols-2 gap-4">
                        {ELEMENTS.map((item, index) => (
                        <button key={item.id} onClick={() => onSelect(item)} className="glass-card aspect-square rounded-3xl p-5 flex flex-col items-center justify-center text-center gap-4 group relative overflow-hidden animate-fade-in-up" style={{ background: theme.cardBg, borderWidth: '1px', borderStyle: 'solid', borderColor: theme.cardBorder, animationDelay: `${index * 0.1}s` }}>
                            <div className="absolute inset-0 opacity-0 group-hover:opacity-20 transition-opacity duration-500 blur-2xl" style={{ background: theme.accent }} />
                            <div className="relative w-16 h-16 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-500 shadow-lg" style={{ background: theme.id === 'light' ? '#ffffff' : 'rgba(255,255,255,0.08)', color: theme.accent, boxShadow: `0 4px 20px ${theme.shadow}` }}><IconComponent icon={item.icon} /></div>
                            <div className="relative"><h3 style={{ color: theme.text }} className="text-lg font-serif mb-1 font-semibold">{item.title}</h3><p style={{ color: theme.secondary }} className="text-xs leading-snug opacity-90 font-light">{item.desc}</p></div>
                        </button>
                        ))}
                    </div>
                    </div>
                </div>
                </PageTransition>
            );
        };

        const ScreenDoor = ({ onSelect, onBack, theme }) => (
            <PageTransition>
                <ProgressBar current={3} total={4} theme={theme} />
                <BackButton onClick={onBack} theme={theme} />
                <div className="flex flex-col w-full h-full justify-center relative pt-20">
                <div className="px-6 mb-12 text-center shrink-0 animate-fade-in-up">
                    <span style={{ color: theme.accent }} className="text-[10px] tracking-[0.4em] uppercase block mb-4 font-semibold">–§–∏–Ω–∞–ª—å–Ω—ã–π –®–∞–≥</span>
                    <h2 style={{ color: theme.text }} className="text-3xl display-font font-semibold mb-3">–ö—É–¥–∞ –≤–µ–¥–µ—Ç<br/>—Ç–≤–æ–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ?</h2>
                    <p style={{ color: theme.secondary }} className="text-sm italic font-light">–í—ã–±–µ—Ä–∏ –¥–≤–µ—Ä—å —Å–≤–æ–µ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
                </div>
                <div className="flex-1 w-full overflow-y-auto pb-24 px-6 scrollbar-hide">
                    <div className="space-y-4">
                    {DOORS.map((door, index) => (
                        <button key={door.id} onClick={() => onSelect(door)} className="w-full py-6 px-7 rounded-2xl border-2 flex items-center justify-between group transition-all duration-500 shrink-0 animate-fade-in-up relative overflow-hidden" style={{ borderColor: theme.cardBorder, background: theme.cardBg, animationDelay: `${index * 0.1}s` }}>
                        <div className="absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-500" style={{ background: theme.accent }} />
                        <div className="text-left relative z-10"><h3 style={{ color: theme.text }} className="text-xl font-serif mb-1 group-hover:translate-x-2 transition-transform duration-300 font-semibold">{door.title}</h3><p style={{ color: theme.secondary }} className="text-sm font-light">{door.desc}</p></div>
                        <div className="w-12 h-12 rounded-full flex items-center justify-center group-hover:scale-110 transition-all duration-500 relative z-10" style={{ background: theme.id === 'light' ? '#ffffff' : 'rgba(255,255,255,0.05)', border: `1px solid ${theme.cardBorder}` }}><ArrowRight style={{ color: theme.accent }} className="w-5 h-5 group-hover:translate-x-1 transition-transform duration-300" /></div>
                        </button>
                    ))}
                    </div>
                </div>
                </div>
            </PageTransition>
        );

        const ScreenAnalysis = ({ onComplete, theme }) => {
            const [text, setText] = useState("–í–¥–æ—Ö...");
            const [dots, setDots] = useState("");
            useEffect(() => {
                const timer = setTimeout(onComplete, 6000);
                const breatheCycle = setInterval(() => { setText(prev => prev === "–í–¥–æ—Ö..." ? "–í—ã–¥–æ—Ö..." : "–í–¥–æ—Ö..."); }, 3000);
                const dotsCycle = setInterval(() => { setDots(prev => prev.length >= 3 ? "" : prev + "."); }, 500);
                return () => { clearTimeout(timer); clearInterval(breatheCycle); clearInterval(dotsCycle); };
            }, []);
            return (
                <PageTransition>
                <ProgressBar current={4} total={4} theme={theme} />
                <div className="flex-1 flex flex-col items-center justify-center p-8 text-center relative overflow-hidden w-full h-full">
                    <div className="relative z-10 animate-fade-in-up">
                    <div className="relative w-72 h-72 mb-16 flex items-center justify-center">
                        <div className="absolute inset-0 rounded-full opacity-20 animate-breathe" style={{ background: theme.accent, filter: 'blur(50px)', animationDuration: '6s' }} />
                        <div className="absolute inset-12 rounded-full opacity-30 animate-breathe" style={{ background: theme.accent, filter: 'blur(30px)', animationDelay: '0.3s', animationDuration: '6s' }} />
                        <div className="absolute inset-20 rounded-full opacity-40 animate-breathe" style={{ background: theme.accent, filter: 'blur(20px)', animationDelay: '0.6s', animationDuration: '6s' }} />
                        <div className="animate-breathe" style={{ animationDuration: '6s' }}><Heart style={{ color: theme.text, fill: `${theme.accent}40` }} className="w-28 h-28 animate-float" /></div>
                    </div>
                    <h2 style={{ color: theme.text }} className="text-3xl font-serif mb-3 tracking-widest uppercase">{text}</h2>
                    <p style={{ color: theme.secondary }} className="text-sm font-light mt-2">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ{dots}</p>
                    </div>
                </div>
                </PageTransition>
            );
        };

        const ScreenResult = ({ data, theme, onRestart }) => {
            const resultKey = getResultKey(data.element.id, data.door.id);
            const result = RESULTS[resultKey];
            const [isRevealed, setIsRevealed] = useState(false);
            const IconComponent = ({ icon: Icon }) => <Icon className="w-5 h-5" />;
            const ElementIcon = ({ icon: Icon }) => <Icon className="w-3 h-3" style={{ color: theme.accent }} />;

            // Generate Telegram Link
            const telegramMessage = encodeURIComponent(
                `–ü—Ä–∏–≤–µ—Ç! ‚ú®\n–Ø –ø—Ä–æ—à–ª–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É ¬´–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –õ–∞–Ω–¥—à–∞—Ñ—Ç¬ª.\n\n` +
                `üåô –ü–µ–π–∑–∞–∂: ${data.landscape.title} (${data.landscape.trait})\n` +
                `üî• –°—Ç–∏—Ö–∏—è: ${data.element.title}\n` +
                `üö™ –ù–∞–º–µ—Ä–µ–Ω–∏–µ: ${data.door.title}\n\n` +
                `–ú–æ—è –∫–∞—Ä—Ç–∞: ${result.cardTitle}\n` +
                `–ú–æ–π —Ä–µ—Å—É—Ä—Å: ${result.title}\n\n` +
                `–•–æ—á—É –∑–∞–±—Ä–∞—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É! üéÅ`
            );
            const telegramUrl = `https://t.me/kseniia_burakova?text=${telegramMessage}`;

            return (
                <div className="w-full h-full relative" style={{ background: theme.bgGradient }}>
                <div className="absolute inset-0 opacity-30 pointer-events-none overflow-hidden">
                    <div className="absolute top-1/4 left-1/4 w-96 h-96 rounded-full blur-3xl animate-breathe" style={{ background: result.color, animationDuration: '8s' }} />
                    <div className="absolute bottom-1/4 right-1/4 w-96 h-96 rounded-full blur-3xl animate-breathe" style={{ background: theme.accent, animationDuration: '10s', animationDelay: '2s' }} />
                </div>
                <div className="absolute inset-0 opacity-5 pointer-events-none" style={{ backgroundImage: `url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23${theme.accent.substring(1)}' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")` }} />

                <div className="h-full overflow-y-auto scrollbar-hide flex flex-col items-center py-20 px-6">
                    <div className="relative z-20 w-full max-w-sm mb-10 animate-fade-in-up shrink-0">
                        {/* THE CARD - FIXED HEIGHT AND BACKGROUND IMAGE */}
                        <div 
                            className="w-full rounded-3xl overflow-hidden shadow-2xl border-2 relative group bg-gray-800"
                            style={{ 
                                height: '400px', 
                                minHeight: '400px',
                                borderColor: `${theme.accent}60`, 
                                boxShadow: `0 25px 80px ${theme.shadow}, 0 0 50px ${result.color}30`,
                                backgroundImage: `url(${result.cardImage})`,
                                backgroundSize: 'cover',
                                backgroundPosition: 'center',
                                backgroundRepeat: 'no-repeat'
                            }}
                        >
                            {/* Fallback gradient if image fails to load or is loading */}
                            <div className="absolute inset-0 z-0 flex flex-col items-center justify-center p-6 text-center" style={{ background: `linear-gradient(135deg, ${result.color}, ${theme.accent})`, zIndex: -1 }}>
                                <Sparkles className="w-16 h-16 text-white mb-4 opacity-50" />
                            </div>

                            <div className="absolute inset-0 bg-gradient-to-t from-black via-black/30 to-transparent opacity-60 z-10" />
                            
                            <div className="absolute inset-0 p-8 flex flex-col justify-between z-20">
                                <div className="flex justify-center">
                                    <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full backdrop-blur-md border" style={{ background: 'rgba(255,255,255,0.1)', borderColor: 'rgba(255,255,255,0.2)' }}>
                                        <IconComponent icon={result.icon} />
                                        <span className="text-white text-xs tracking-wider uppercase font-semibold">–¢–≤–æ—è –ö–∞—Ä—Ç–∞</span>
                                    </div>
                                </div>
                                <div className="text-center">
                                    <div className="w-16 h-1 mx-auto mb-4 rounded-full" style={{ background: theme.accent }} />
                                    <h2 className="text-3xl text-white display-font leading-tight font-bold drop-shadow-md">{result.cardTitle}</h2>
                                </div>
                            </div>
                        </div>
                        
                        <div className="flex justify-center mt-6 gap-3">
                            <button onClick={() => { if (navigator.share) { navigator.share({ title: 'Fire of Life - –ú–æ—è –ö–∞—Ä—Ç–∞', text: `–Ø –ø–æ–ª—É—á–∏–ª–∞ –∫–∞—Ä—Ç—É "${result.cardTitle}" –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ Fire of Life`, url: window.location.href }).catch(() => {}); } }} className="px-6 py-3 rounded-full backdrop-blur-md border flex items-center gap-2 transition-all hover:scale-105" style={{ background: theme.cardBg, borderColor: theme.cardBorder, color: theme.text }}>
                                <Share2 className="w-4 h-4" />
                                <span className="text-sm font-medium">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
                            </button>
                        </div>
                    </div>

                    {!isRevealed ? (
                    <div className="relative z-20 text-center animate-fade-in-up max-w-md w-full pb-24">
                        <p className="text-base mb-8 leading-relaxed italic px-4" style={{ color: theme.text, opacity: 0.9 }}>¬´–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ –∫–∞—Ä—Ç—É. –û —á–µ–º —ç—Ç–æ—Ç –æ–±—Ä–∞–∑ –¥–ª—è —Ç–µ–±—è —Å–µ–π—á–∞—Å?<br/>–ö–∞–∫–æ–π –æ—Ç–∫–ª–∏–∫ –æ–Ω —Ä–æ–∂–¥–∞–µ—Ç –≤ —Ç–µ–ª–µ?¬ª</p>
                        <button onClick={() => setIsRevealed(true)} className="btn-primary inline-flex items-center justify-center gap-3 px-10 py-5 w-full rounded-full font-bold uppercase tracking-widest text-sm transition-all shadow-2xl hover:scale-105 active:scale-95" style={{ backgroundColor: theme.accent, color: theme.buttonText, boxShadow: `0 15px 40px ${theme.accent}50` }}><Lock className="w-4 h-4" /><span>–û—Ç–∫—Ä—ã—Ç—å –ü–æ—Å–ª–∞–Ω–∏–µ</span></button>
                    </div>
                    ) : (
                    <div className="w-full max-w-lg animate-fade-in-up pb-24">
                        <div className="rounded-3xl p-8 shadow-2xl text-center relative overflow-hidden" style={{ backgroundColor: theme.id === 'light' ? '#ffffff' : '#1a1625', color: theme.id === 'light' ? '#1a1625' : '#f2f0e8', boxShadow: `0 25px 80px ${theme.shadow}` }}>
                            <div className="absolute top-0 left-0 right-0 h-1" style={{ background: `linear-gradient(90deg, ${theme.accent}, ${result.color})` }} />
                            <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full border mb-8" style={{ borderColor: `${theme.accent}40`, backgroundColor: `${theme.accent}15` }}><Star className="w-4 h-4" style={{ color: theme.accent, fill: theme.accent }} /><span className="text-xs font-bold tracking-widest uppercase" style={{ color: theme.accent }}>–¢–≤–æ–π –†–µ—Å—É—Ä—Å</span></div>
                            <h3 className="text-3xl display-font mb-5 leading-tight font-bold" style={{ color: theme.id === 'light' ? '#1a1625' : theme.text }}>{result.title}</h3>
                            <p className="text-base leading-relaxed mb-10 font-light" style={{ color: theme.id === 'light' ? '#5c5c5c' : theme.secondary }}>{result.text}</p>
                            <div className="rounded-2xl p-5 mb-8 text-left" style={{ background: theme.id === 'light' ? '#f9f7f4' : 'rgba(255,255,255,0.05)', border: `1px solid ${theme.cardBorder}` }}>
                                <h4 className="text-sm uppercase tracking-wider mb-4 font-bold" style={{ color: theme.accent }}>–¢–≤–æ–π –ü—É—Ç—å</h4>
                                <div className="space-y-3 text-sm">
                                    <div className="flex items-start gap-3"><div className="w-6 h-6 rounded-full flex items-center justify-center shrink-0 mt-0.5" style={{ background: `${theme.accent}20` }}><Eye className="w-3 h-3" style={{ color: theme.accent }} /></div><div><span className="font-semibold">{data.landscape.title}</span><span className="opacity-60"> ‚Äî {data.landscape.trait}</span></div></div>
                                    <div className="flex items-start gap-3"><div className="w-6 h-6 rounded-full flex items-center justify-center shrink-0 mt-0.5" style={{ background: `${theme.accent}20` }}><ElementIcon icon={data.element.icon} /></div><div><span className="font-semibold">{data.element.title}</span><span className="opacity-60"> ‚Äî {data.element.type}</span></div></div>
                                    <div className="flex items-start gap-3"><div className="w-6 h-6 rounded-full flex items-center justify-center shrink-0 mt-0.5" style={{ background: `${theme.accent}20` }}><Star className="w-3 h-3" style={{ color: theme.accent }} /></div><div><span className="font-semibold">{data.door.title}</span><span className="opacity-60"> ‚Äî {data.door.desc}</span></div></div>
                                </div>
                            </div>
                            <div className="rounded-2xl p-5 mb-8 flex items-center gap-4" style={{ background: theme.id === 'light' ? '#ffffff' : 'rgba(255,255,255,0.03)', border: `1px solid ${theme.cardBorder}`, boxShadow: `0 4px 20px ${theme.shadow}` }}>
                                <div className="w-14 h-14 rounded-2xl flex items-center justify-center shrink-0 shadow-md" style={{ background: theme.id === 'light' ? '#f9f7f4' : 'rgba(255,255,255,0.08)' }}><Flame className="w-6 h-6" style={{ color: result.color }} /></div>
                                <div className="flex-1 text-left"><p className="text-xs uppercase tracking-wider mb-1 font-semibold" style={{ color: theme.id === 'light' ? '#999' : theme.secondary }}>–Ø–∫–æ—Ä—å –°–æ—Å—Ç–æ—è–Ω–∏—è</p><h4 className="font-serif font-bold text-base" style={{ color: theme.id === 'light' ? '#1a1625' : theme.text }}>{result.productName}</h4></div>
                                <a href="http://fire-of-life.ru/katalog" target="_blank" rel="noopener noreferrer" className="w-11 h-11 rounded-full flex items-center justify-center transition-all hover:scale-110" style={{ backgroundColor: theme.accent }}><ArrowRight className="w-5 h-5" style={{ color: theme.buttonText }} /></a>
                            </div>
                            <div className="rounded-2xl p-6" style={{ background: theme.id === 'light' ? '#fcfbf9' : 'rgba(212,175,55,0.05)', border: `1px solid ${theme.cardBorder}` }}>
                                <div className="flex items-center gap-2 mb-4 justify-center"><Gift className="w-5 h-5" style={{ color: theme.accent }} /><h4 className="text-base font-bold uppercase tracking-wider" style={{ color: theme.id === 'light' ? '#1a1625' : theme.text }}>–ú–æ–π –ø–æ–¥–∞—Ä–æ–∫ —Ç–µ–±–µ</h4></div>
                                <p className="text-sm mb-5 leading-relaxed" style={{ color: theme.id === 'light' ? '#5c5c5c' : theme.secondary }}>–ë—É–¥—É —Ä–∞–¥–∞ —Å—Ç–∞—Ç—å –≤–∫–ª–∞–¥–æ–º –≤ —Ç–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –≠—Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ.</p>
                                <a href={telegramUrl} target="_blank" rel="noreferrer" className="btn-primary block w-full py-4 rounded-2xl text-center text-sm font-bold uppercase tracking-widest transition-all shadow-lg hover:shadow-xl hover:-translate-y-1" style={{ backgroundColor: theme.accent, color: theme.buttonText }}>–ó–∞–±—Ä–∞—Ç—å –ü—Ä–∞–∫—Ç–∏–∫—É</a>
                            </div>
                        </div>
                        <button onClick={onRestart} className="w-full mt-10 text-sm flex items-center justify-center gap-2 transition-all opacity-50 hover:opacity-100" style={{ color: theme.text }}><RotateCcw className="w-4 h-4" /><span>–ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</span></button>
                    </div>
                    )}
                </div>
                </div>
            );
        };

        // --- MAIN APP ---
        const MobileContainer = ({ children, theme }) => (
            <div className="fixed inset-0 w-full h-full" style={{ background: theme.bgGradient }}>
                <div className="w-full h-full flex items-center justify-center p-0 md:p-6">
                <div className="relative w-full md:max-w-[420px] h-full md:max-h-[900px] md:h-[850px] shadow-2xl overflow-hidden md:rounded-[40px] flex flex-col transition-all duration-700" style={{ backgroundColor: theme.bg, boxShadow: `0 30px 100px ${theme.shadow}` }}>
                    <div className="absolute inset-0 overflow-y-auto scrollbar-hide">{children}</div>
                </div>
                </div>
            </div>
        );

        const App = () => {
            const [step, setStep] = useState('intro');
            const [currentTheme, setCurrentTheme] = useState(THEMES.dark);
            const [history, setHistory] = useState({ landscape: null, element: null, door: null });

            const handleThemeSelect = (themeId) => { setCurrentTheme(THEMES[themeId]); setStep('landscape'); };
            const handleLandscapeSelect = (item) => { setHistory(prev => ({ ...prev, landscape: item })); setStep('element'); };
            const handleElementSelect = (item) => { setHistory(prev => ({ ...prev, element: item })); setStep('door'); };
            const handleDoorSelect = (item) => { setHistory(prev => ({ ...prev, door: item })); setStep('analysis'); };
            const handleAnalysisComplete = () => { setStep('result'); };
            const handleRestart = () => { setStep('intro'); setHistory({ landscape: null, element: null, door: null }); };
            const handleBack = () => {
                const steps = ['intro', 'landscape', 'element', 'door', 'analysis', 'result'];
                const currentIndex = steps.indexOf(step);
                if (currentIndex > 0) setStep(steps[currentIndex - 1]);
            };

            return (
                <MobileContainer theme={currentTheme}>
                {step === 'intro' && <ScreenIntro onSelectTheme={handleThemeSelect} />}
                {step === 'landscape' && <ScreenLandscape onSelect={handleLandscapeSelect} onBack={handleBack} theme={currentTheme} />}
                {step === 'element' && <ScreenElement landscape={history.landscape} onSelect={handleElementSelect} onBack={handleBack} theme={currentTheme} />}
                {step === 'door' && <ScreenDoor onSelect={handleDoorSelect} onBack={handleBack} theme={currentTheme} />}
                {step === 'analysis' && <ScreenAnalysis onComplete={handleAnalysisComplete} theme={currentTheme} />}
                {step === 'result' && <ScreenResult data={history} onRestart={handleRestart} theme={currentTheme} />}
                </MobileContainer>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
